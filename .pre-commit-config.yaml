# Modern Pre-commit Configuration for mcp_server_openai
# Optimized for 2025 with Ruff as the primary Python toolchain
repos:
  # Essential file checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
        args: [--markdown-linebreak-ext=md]
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-json
      - id: check-toml
      - id: check-added-large-files
        args: [--maxkb=1000]
      - id: check-merge-conflict
      - id: mixed-line-ending
        args: [--fix=lf]
      - id: debug-statements

  # Modern Python toolchain - Ruff (replaces Black, isort, Flake8, pyupgrade, etc.)
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.6.2
    hooks:
      # Ruff linter with auto-fix
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]
      # Ruff formatter (replaces Black)
      - id: ruff-format

  # (Removed) mirrors-mypy hook to avoid duplicate/commit-time type checks

  # Local project-specific hooks
  - repo: local
    hooks:
      # Custom preflight script (manual trigger)
      - id: preflight-custom
        name: Custom Preflight Script
        entry: uv run python scripts/utilities/preflight.py
        language: system
        types: [python]
        pass_filenames: false
        stages: [manual]

      # Fast test suite for pre-push
      - id: fast-tests
        name: Fast Test Suite
        entry: make test-fast
        language: system
        types: [python]
        pass_filenames: false
        stages: [pre-push]

      # MyPy core files check (manual only to reduce dev friction)
      - id: mypy-core
        name: MyPy Core Files
        entry: make mypy-check
        language: system
        types: [python]
        pass_filenames: false
        stages: [manual]

# Configuration
fail_fast: false
default_install_hook_types: [pre-commit, pre-push]
minimum_pre_commit_version: '3.0.0'
